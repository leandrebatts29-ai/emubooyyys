<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Old Vidja G*mes</title>
    <style>
        body { background: #1a1a1a; color: white; font-family: sans-serif; text-align: center; margin: 0; padding: 20px; }
        h1 { color: #ffcc00; }
        
        /* Grid Layout */
        .menu { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 10px; max-width: 1200px; margin: 0 auto; }
        .system-label { grid-column: 1 / -1; text-align: left; border-bottom: 2px solid #333; margin-top: 30px; padding-bottom: 5px; color: #aaa; font-weight: bold; }
        
        button { padding: 12px; background: #333; color: white; border: 1px solid #444; border-radius: 5px; cursor: pointer; font-size: 14px; }
        button:hover { background: #555; border-color: #ffcc00; }

        /* POPUP MODAL STYLES */
        #game-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1000; }
        #emulator-holder { width: 100%; height: 100%; }
        .close-btn { position: absolute; top: 10px; right: 20px; background: red; color: white; border: none; padding: 10px 15px; cursor: pointer; z-index: 1001; font-weight: bold; border-radius: 5px; }
    </style>
</head>
<body>

    </h1>Classics Library</h1>

    <div class="menu">
        <div class="system-label">Sega 32X</div>
        <button onclick="loadGame('sega32x', '32x/Knuckles_ Chaotix (1995)(Sega)(JP-US)(en).bin')">Knuckles’ Chaotix</button>
        <button onclick="loadGame('sega32x', '32x/Tempo (1995)(Sega)(JP-US)(en).bin')">Tempo</button>

        <div class="system-label">Arcade</div>
        <button onclick="loadGame('mame', 'arcade/frogger.zip')">Frogger</button>
        <button onclick="loadGame('mame', 'arcade/galaga.zip')">Galaga</button>
        <button onclick="loadGame('mame', 'arcade/invaders.zip')">Space Invaders</button>
        <button onclick="loadGame('mame', 'arcade/pacman.zip')">Pac-Man</button>
        <button onclick="loadGame('mame', 'arcade/sonic.zip')">SegaSonic the Hedgehog</button>
        <button onclick="loadGame('mame', 'arcade/soniccar.zip')">Waku Waku Sonic Patrol Car</button>
        <button onclick="loadGame('mame', 'arcade/sonicfgt.zip')">SegaSonic Cosmo Fighter</button>
        <button onclick="loadGame('mame', 'arcade/sonicpop.zip')">SegaSonic Popcorn Shop</button>

        <div class="system-label">Sega Genesis</div>
        <button onclick="loadGame('genesis', 'genesis/Bubsy in Claws Encounters of the Furred Kind (USA).md')">Bubsy in Claws Encounters of the Furred Kind</button>
        <button onclick="loadGame('genesis', 'genesis/Disney_s Toy Story (USA).md')">Toy Story</button>
        <button onclick="loadGame('genesis', 'genesis/Dr. Robotnik_s Mean Bean Machine (USA).md')">Dr. Robotnik's Mean Bean Machine</button>
        <button onclick="loadGame('genesis', 'genesis/Garfield - Caught in the Act (USA).md')">Garfield: Caught in the Act</button>
        <button onclick="loadGame('genesis', 'genesis/Mickey Mania - The Timeless Adventures of Mickey Mouse (USA).md')">Mickey Mania</button>
        <button onclick="loadGame('genesis', 'genesis/Sonic & Knuckles (Blue Sphere) (USA) (Lock-on).md')">Blue Sphere</button>
        <button onclick="loadGame('genesis', 'genesis/Sonic the Hedgehog (USA).md')">Sonic the Hedgehog </button>
        <button onclick="loadGame('genesis', 'genesis/Sonic The Hedgehog 2 (World).md')">Sonic the Hedgehog 2</button>
        <button onclick="loadGame('genesis', 'genesis/Sonic & Knuckles (Sonic the Hedgehog 3 & Knuckles) (USA) (Lock-on).md')">Sonic 3 & Knuckles</button>
        <button onclick="loadGame('genesis', 'genesis/Sonic Spinball (USA).md')">Sonic Spinball</button>
        <button onclick="loadGame('genesis', 'genesis/Sonic 3D Blast (USA).md')">Sonic 3D Blast</button>
        <button onclick="loadGame('genesis', 'genesis/Sonic 3 Complete (Sonic & Knuckles modification) (130810).md')">Sonic 3 Complete</button>
        <button onclick="loadGame('genesis', 'genesis/Sonic Classic Heroes (Sonic the Hedgehog 2 modification) (0.10.008a).md')">Sonic Classic Heroes</button>
        <button onclick="loadGame('genesis', 'genesis/Sonic 1 Megamix (Sonic the Hedgehog modification) (3.0).md')">Sonic Megamix</button>
        <button onclick="loadGame('genesis', 'genesis/Sonic Delta 40mb.bin')">Sonic Delta 40mb</button>

        <div class="system-label">NES</div>
        <button onclick="loadGame('nes', 'nes/Action 52 (USA) (Rev A) (Unl).nes')">Action 52</button>
        <button onclick="loadGame('nes', 'nes/Balloon Fight (USA).nes')">Balloon Fight</button>
        <button onclick="loadGame('nes', 'nes/Donkey Kong Classics (USA, Europe).nes')">Donkey Kong Classics</button>
        <button onclick="loadGame('nes', 'nes/DuckTales (USA).nes')">DuckTales</button>
        <button onclick="loadGame('nes', 'nes/Kirby_s Adventure (USA).nes')">Kirby’s Adventure</button>
        <button onclick="loadGame('nes', 'nes/Legend of Zelda, The (USA).nes')">The Legend of Zelda</button>
        <button onclick="loadGame('nes', 'nes/Mario Bros. (World).nes')">Mario Bros.</button>
        <button onclick="loadGame('nes', 'nes/Mickey Mousecapade (USA).nes')">Mickey Mousecapade</button>
        <button onclick="loadGame('nes', 'nes/Pac-Man (USA) (Namco).nes')">Pac-Man</button>
        <button onclick="loadGame('nes', 'nes/Super Mario Bros. (World).nes')">Super Mario Bros.</button>
        <button onclick="loadGame('nes', 'nes/Super Mario Bros. 2 (USA).nes')">Super Mario Bros. 2</button>
        <button onclick="loadGame('nes', 'nes/Super Mario Bros. 3 (USA).nes')">Super Mario Bros. 3</button>
        <button onclick="loadGame('nes', 'nes/Tetris (USA).nes')">Tetris</button>
        <button onclick="loadGame('nes', 'nes/Zelda II - The Adventure of Link (USA).nes')">Zelda II: the Adventure of Link</button>
    </div>

    <div class="menu">
        <div class="system-label">Super Nintendo</div>
        <button onclick="loadGame('snes', 'snes/Donkey Kong Country (USA) (Rev 2).sfc')">Donkey Kong Country</button>
        <button onclick="loadGame('snes', 'snes/Donkey Kong Country 2 - Diddy_s Kong Quest (USA) (En,Fr) (Rev 1).sfc')">Donkey Kong Country 2: Diddy's Kong Quest</button>
        <button onclick="loadGame('snes', 'snes/Donkey Kong Country 3 - Dixie Kong_s Double Trouble! (USA) (En,Fr).sfc')">Donkey Kong Country 3: Dixie Kong's Double Trouble</button>
        <button onclick="loadGame('snes', 'snes/Kirby_s Avalanche (USA).sfc')">Kirby's Avalanche</button>
        <button onclick="loadGame('snes', 'snes/Kirby_s Dream Course (USA).sfc')">Kirby's Dream Course</button>
        <button onclick="loadGame('snes', 'snes/Kirby_s Dream Land 3 (USA).sfc')">Kirby's Dream Land 3</button>
        <button onclick="loadGame('snes', 'snes/Mario Is Missing! (USA).sfc')">Mario is Missing!</button>
        <button onclick="loadGame('snes', 'snes/Super Mario All-Stars (USA).sfc')">Super Mario All-Stars</button>
        <button onclick="loadGame('snes', 'snes/Super Mario Kart (USA).sfc')">Super Mario Kart</button>
        <button onclick="loadGame('snes', 'snes/Super Mario RPG - Legend of the Seven Stars (USA).sfc')">Super Mario RPG - Legend of the Seven Stars</button>
        <button onclick="loadGame('snes', 'snes/Super Mario World (USA).sfc')">Super Mario World</button>
        <button onclick="loadGame('snes', 'snes/Super Mario World 2 - Yoshi_s Island (USA).sfc')">Super Mario World 2: Yoshi's Island</button>

        </div>

    <div id="game-modal">
        <button class="close-btn" onclick="closeGame()">Close Game ✖</button>
        <div id="emulator-holder"></div>
    </div>

<div style="margin-bottom: 20px;">
    <input type="text" id="gameSearch" placeholder="Search for a game..." 
           style="padding: 10px; width: 80%; max-width: 400px; border-radius: 5px; border: 1px solid #444; background: #222; color: white;">
</div>

<script>
    // Force the correct base URL
    const repoBase = "https://leandrebatts29-ai.github.io/emubooyyys/";

    function launch(sys, romPath) {
        // 1. Immediately show modal and nuke the old player
        document.getElementById('game-modal').style.display = 'block';
        const container = document.getElementById('game-container');
        container.innerHTML = '<div id="ejs-instance"></div>';

        // 2. Strict Variable Assignment (No defaults allowed)
        let coreToUse = "";
        let buttonLayout = {};

        if (sys === 'nes') {
            coreToUse = 'fceumm';
            buttonLayout = { '0': 'B', '1': 'A', '8': 'Select', '9': 'Start', '12': 'Up', '13': 'Down', '14': 'Left', '15': 'Right' };
        } else if (sys === 'snes') {
            coreToUse = 'snes9x';
            buttonLayout = { '0': 'B', '1': 'A', '2': 'Y', '3': 'X', '4': 'L', '5': 'R', '8': 'Select', '9': 'Start', '12': 'Up', '13': 'Down', '14': 'Left', '15': 'Right' };
        } else if (sys === 'genesis' || sys === 'sega32x') {
            coreToUse = (sys === 'genesis') ? 'genesis_plus_gx' : 'picodrive';
            buttonLayout = { '0': 'B', '1': 'C', '2': 'A', '3': 'X', '4': 'Y', '5': 'Z', '9': 'Start', '12': 'Up', '13': 'Down', '14': 'Left', '15': 'Right' };
        } else if (sys === 'mame') {
            coreToUse = 'mame2003plus';
            buttonLayout = { '0': 'Button 1', '1': 'Button 2', '8': 'Coin', '9': 'Start', '12': 'Up', '13': 'Down', '14': 'Left', '15': 'Right' };
        }

        // 3. Set Global Variables for EmulatorJS
        window.EJS_player = '#emulator-holder';
        window.EJS_core = coreToUse;
        window.EJS_gameUrl = repoBase + romPath;
        window.EJS_pathtodata = 'https://cdn.emulatorjs.org/stable/data/';
        window.EJS_buttons = buttonLayout;
        window.EJS_startOnLoaded = true;

        // 4. Inject the Loader with a unique ID to prevent cache issues
        const oldLoader = document.getElementById('ejs-loader-script');
        if (oldLoader) oldLoader.remove();

        const loader = document.createElement('script');
        loader.id = 'ejs-loader-script';
        loader.src = 'https://cdn.emulatorjs.org/stable/data/loader.js?timestamp=' + new Date().getTime();
        document.head.appendChild(loader);
    }

    function quit() {
        // This is the ONLY way to clear EmulatorJS memory and variables 100%
        window.location.href = window.location.pathname + "?t=" + new Date().getTime();
    }
</script>
</body>
</html>
