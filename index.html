<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Old Vidja G*mes</title>
    <style>
        body { background: #1a1a1a; color: white; font-family: sans-serif; text-align: center; margin: 0; padding: 20px; }
        h1 { color: #ffcc00; }
        
        /* Grid Layout */
        .menu { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 10px; max-width: 1200px; margin: 0 auto; }
        .system-label { grid-column: 1 / -1; text-align: left; border-bottom: 2px solid #333; margin-top: 30px; padding-bottom: 5px; color: #aaa; font-weight: bold; }
        
        button { padding: 12px; background: #333; color: white; border: 1px solid #444; border-radius: 5px; cursor: pointer; font-size: 14px; }
        button:hover { background: #555; border-color: #ffcc00; }

        /* POPUP MODAL STYLES */
        #game-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1000; }
        #emulator-holder { width: 100%; height: 100%; }
        .close-btn { position: absolute; top: 10px; right: 20px; background: red; color: white; border: none; padding: 10px 15px; cursor: pointer; z-index: 1001; font-weight: bold; border-radius: 5px; }
    </style>
</head>
<body>

    </h1>Classics Library</h1>

    <div class="menu">
        <div class="system-label">Sega 32X</div>
        <button onclick="loadGame('sega32x', '32x/Knuckles_%20Chaotix%20(1995)(Sega)(JP-US)(en).bin')">Knuckles’ Chaotix</button>
        <button onclick="loadGame('sega32x', '32x/Tempo%20(1995)(Sega)(JP-US)(en).bin')">Tempo</button>

        <div class="system-label">Arcade</div>
        <button onclick="loadGame('mame', 'arcade/frogger.zip')">Frogger</button>
        <button onclick="loadGame('mame', 'arcade/galaga.zip')">Galaga</button>
        <button onclick="loadGame('mame', 'arcade/invaders.zip')">Space Invaders</button>
        <button onclick="loadGame('mame', 'arcade/pacman.zip')">Pac-Man</button>
        <button onclick="loadGame('mame', 'arcade/sonic.zip')">SegaSonic the Hedgehog</button>
        <button onclick="loadGame('mame', 'arcade/soniccar.zip')">Waku Waku Sonic Patrol Car</button>
        <button onclick="loadGame('mame', 'arcade/sonicfgt.zip')">SegaSonic Cosmo Fighter</button>
        <button onclick="loadGame('mame', 'arcade/sonicpop.zip')">SegaSonic Popcorn Shop</button>

        <div class="system-label">Sega Genesis</div>
        <button onclick="loadGame('genesis', 'genesis/Bubsy%20in%20Claws%20Encounters%20of%20the%20Furred%20Kind%20(USA).md')">Bubsy in Claws Encounters of the Furred Kind</button>
        <button onclick="loadGame('genesis', 'genesis/Disney_s%20Toy%20Story%20(USA).md')">Toy Story</button>
        <button onclick="loadGame('genesis', 'genesis/Dr.%20Robotnik_s%20Mean%20Bean%20Machine%20(USA).md')">Dr. Robotnik's Mean Bean Machine</button>
        <button onclick="loadGame('genesis', 'genesis/Garfield%20-%20Caught%20in%20the%20Act%20(USA).md')">Garfield: Caught in the Act</button>
        <button onclick="loadGame('genesis', 'genesis/Mickey%20Mania%20-%20The%20Timeless%20Adventures%20of%20Mickey%20Mouse%20(USA).md')">Mickey Mania</button>
        <button onclick="loadGame('genesis', 'genesis/Sonic%20&%20Knuckles%20(Blue%20Sphere)%20(USA)%20(Lock-on).md')">Blue Sphere</button>
        <button onclick="loadGame('genesis', 'genesis/Sonic%20the%20Hedgehog%20(USA).md')">Sonic the Hedgehog </button>
        <button onclick="loadGame('genesis', 'genesis/Sonic%20The%20Hedgehog%202%20(World).md')">Sonic the Hedgehog 2</button>
        <button onclick="loadGame('genesis', 'genesis/Sonic%20&%20Knuckles%20(Sonic%20the%20Hedgehog%203%20&%20Knuckles)%20(USA)%20(Lock-on).md')">Sonic 3 & Knuckles</button>
        <button onclick="loadGame('genesis', 'genesis/Sonic%20Spinball%20(USA).md')">Sonic Spinball</button>
        <button onclick="loadGame('genesis', 'genesis/Sonic%203D%20Blast%20(USA).md')">Sonic 3D Blast</button>
        <button onclick="loadGame('genesis', 'genesis/Sonic%203%20Complete%20(Sonic%20&%20Knuckles%20modification)%20(130810).md')">Sonic 3 Complete</button>
        <button onclick="loadGame('genesis', 'genesis/Sonic%20Classic%20Heroes%20(Sonic%20the%20Hedgehog%202%20modification)%20(0.10.008a).md')">Sonic Classic Heroes</button>
        <button onclick="loadGame('genesis', 'genesis/Sonic%201%20Megamix%20(Sonic%20the%20Hedgehog%20modification)%20(3.0).md')">Sonic Megamix</button>
        <button onclick="loadGame('genesis', 'genesis/Sonic%20Delta%2040mb.bin')">Sonic Delta 40mb</button>

        <div class="system-label">NES</div>
        <button onclick="loadGame('nes', 'nes/Action%2052%20(USA)%20(Rev%20A)%20(Unl).nes')">Action 52</button>
        <button onclick="loadGame('nes', 'nes/Balloon%20Fight%20(USA).nes')">Balloon Fight</button>
        <button onclick="loadGame('nes', 'nes/Donkey%20Kong%20Classics%20(USA,%20Europe).nes')">Donkey Kong Classics</button>
        <button onclick="loadGame('nes', 'nes/DuckTales%20(USA).nes')">DuckTales</button>
        <button onclick="loadGame('nes', 'nes/Kirby_s%20Adventure%20(USA).nes')">Kirby’s Adventure</button>
        <button onclick="loadGame('nes', 'nes/Legend%20of%20Zelda,%20The%20(USA).nes')">The Legend of Zelda</button>
        <button onclick="loadGame('nes', 'nes/Mario%20Bros.%20(World).nes')">Mario Bros.</button>
        <button onclick="loadGame('nes', 'nes/Mickey%20Mousecapade%20(USA).nes')">Mickey Mousecapade</button>
        <button onclick="loadGame('nes', 'nes/Pac-Man%20(USA)%20(Namco).nes')">Pac-Man</button>
        <button onclick="loadGame('nes', 'nes/Super%20Mario%20Bros.%20(World).nes')">Super Mario Bros.</button>
        <button onclick="loadGame('nes', 'nes/Super%20Mario%20Bros.%202%20(USA).nes')">Super Mario Bros. 2</button>
        <button onclick="loadGame('nes', 'nes/Super%20Mario%20Bros.%203%20(USA).nes')">Super Mario Bros. 3</button>
        <button onclick="loadGame('nes', 'nes/Tetris%20(USA).nes')">Tetris</button>
        <button onclick="loadGame('nes', 'nes/Zelda%20II%20-%20The%20Adventure%20of%20Link%20(USA).nes')">Zelda II: the Adventure of Link</button>
    </div>

    <div class="menu">
        <div class="system-label">Super Nintendo</div>
        <button onclick="loadGame('snes', 'snes/Donkey%20Kong%20Country%20(USA)%20(Rev%202).sfc')">Donkey Kong Country</button>
        <button onclick="loadGame('snes', 'snes/Donkey%20Kong%20Country%202%20-%20Diddy_s%20Kong%20Quest%20(USA)%20(En,Fr)%20(Rev%201).sfc')">Donkey Kong Country 2: Diddy's Kong Quest</button>
        <button onclick="loadGame('snes', 'snes/Donkey%20Kong%20Country%203%20-%20Dixie%20Kong_s%20Double%20Trouble!%20(USA)%20(En,Fr).sfc')">Donkey Kong Country 3: Dixie Kong's Double Trouble</button>
        <button onclick="loadGame('snes', 'snes/Kirby_s%20Avalanche%20(USA).sfc')">Kirby's Avalanche</button>
        <button onclick="loadGame('snes', 'snes/Kirby_s%20Dream%20Course%20(USA).sfc')">Kirby's Dream Course</button>
        <button onclick="loadGame('snes', 'snes/Kirby_s%20Dream%20Land%203%20(USA).sfc')">Kirby's Dream Land 3</button>
        <button onclick="loadGame('snes', 'snes/Mario%20Is%20Missing!%20(USA).sfc')">Mario is Missing!</button>
        <button onclick="loadGame('snes', 'snes/Super%20Mario%20All-Stars%20(USA).sfc')">Super Mario All-Stars</button>
        <button onclick="loadGame('snes', 'snes/Super%20Mario%20Kart%20(USA).sfc')">Super Mario Kart</button>
        <button onclick="loadGame('snes', 'snes/Super%20Mario%20RPG%20-%20Legend%20of%20the%20Seven%20Stars%20(USA).sfc')">Super Mario RPG - Legend of the Seven Stars</button>
        <button onclick="loadGame('snes', 'snes/Super%20Mario%20World%20(USA).sfc')">Super Mario World</button>
        <button onclick="loadGame('snes', 'snes/Super%20Mario%20World%202%20-%20Yoshi_s%20Island%20(USA).sfc')">Super Mario World 2: Yoshi's Island</button>

        </div>

    <div id="game-modal">
        <button class="close-btn" onclick="closeGame()">Close Game ✖</button>
        <div id="emulator-holder"></div>
    </div>

<div style="margin-bottom: 20px;">
    <input type="text" id="gameSearch" placeholder="Search for a game..." 
           style="padding: 10px; width: 80%; max-width: 400px; border-radius: 5px; border: 1px solid #444; background: #222; color: white;">
</div>

<script>
    const baseUrl = "https://leandrebatts29-ai.github.io/emubooyyys/";

    // --- SEARCH LOGIC ---
    document.getElementById('gameSearch').addEventListener('input', function(e) {
        const term = e.target.value.toLowerCase();
        const buttons = document.querySelectorAll('.menu button');
        buttons.forEach(btn => {
            const text = btn.textContent.toLowerCase();
            btn.style.display = text.includes(term) ? "inline-block" : "none";
        });
    });

    function loadGame(system, relativePath) {
        // Reset Modal and Holder
        document.getElementById('game-modal').style.display = 'block';
        const holder = document.getElementById('emulator-holder');
        holder.innerHTML = '<div id="game"></div>';

        // 1. Rigorous Core Selection
        let selectedCore = '';
        if (system === 'nes') selectedCore = 'fceumm';
        else if (system === 'snes') selectedCore = 'snes9x';
        else if (system === 'genesis') selectedCore = 'genesis_plus_gx';
        else if (system === 'sega32x') selectedCore = 'picodrive';
        else if (system === 'mame') selectedCore = 'mame2003plus';

        // 2. System-Specific Buttons (Strict Mapping)
        let buttons = {};
        if (system === 'nes') {
            buttons = { '0': 'B', '1': 'A', '8': 'Select', '9': 'Start', '12': 'Up', '13': 'Down', '14': 'Left', '15': 'Right' };
        } else if (system === 'snes') {
            buttons = { '0': 'B', '1': 'A', '2': 'Y', '3': 'X', '4': 'L', '5': 'R', '8': 'Select', '9': 'Start', '12': 'Up', '13': 'Down', '14': 'Left', '15': 'Right' };
        } else if (system === 'genesis' || system === 'sega32x') {
            buttons = { '0': 'B', '1': 'C', '2': 'A', '3': 'X', '4': 'Y', '5': 'Z', '8': 'Mode', '9': 'Start', '12': 'Up', '13': 'Down', '14': 'Left', '15': 'Right' };
        } else if (system === 'mame') {
            // MAME 2003+ often uses Button 1 as Start in these mini-games
            buttons = { '0': 'Button 1', '1': 'Button 2', '8': 'Coin', '9': 'Start', '12': 'Up', '13': 'Down', '14': 'Left', '15': 'Right' };
        }

        // 3. Set Global Config
        window.EJS_player = '#game';
        window.EJS_core = selectedCore;
        window.EJS_gameUrl = baseUrl + relativePath;
        window.EJS_pathtodata = 'https://cdn.emulatorjs.org/stable/data/';
        window.EJS_buttons = buttons;
        window.EJS_startOnLoaded = true; // Attempt to bypass menus

        // 4. Clean Load Script (with cache buster)
        const oldScript = document.getElementById('ejs-loader');
        if (oldScript) oldScript.remove();

        let script = document.createElement('script');
        script.id = 'ejs-loader';
        script.src = 'https://cdn.emulatorjs.org/stable/data/loader.js?v=' + Date.now();
        document.head.appendChild(script);
    }

    function closeGame() {
        // Because of the control persistence issue, a hard reload is the 
        // only 100% reliable way to swap systems/controls in the browser.
        location.reload(); 
    }
</script>
</body>
</html>
